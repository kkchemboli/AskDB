# AskDB

AskDB is a Streamlit-powered application that lets you interact with your SQLite databases using natural language queries. It leverages LangChain, LLMs, and Plotly to generate SQL, run queries, and visualize results as interactive charts—all from a simple web interface.

---

## Features

- **Upload any SQLite `.db` file** and query it using plain English.
- **Automatic SQL generation** and execution using LLMs (Ollama backend).
- **Smart charting:** The agent decides the best Plotly chart for your query and generates it.
- **Interactive visualization:** View Plotly charts directly in your browser.
- **Temporary file handling:** Charts are stored as HTML in your system's temp directory.
- **Proper noun search:** Robust handling of names and entities in your database.
- **Secure Python code execution:** Uses a sandboxed environment for running generated code.

---

## Quickstart

### 1. Clone the repository

```bash
git clone https://github.com/kkchemboli/querytovis.git
cd querytovis
```

### 1. Install dependencies

This project uses [uv](https://github.com/astral-sh/uv) as the package manager (a fast Python package installer and resolver).

```bash
uv sync
```

### 2. Start the Streamlit app

```bash
streamlit run frontend.py --server.maxUploadSize 1000
```

### 3. Usage

1. **Upload your SQLite database** (`.db` file) via the web interface.
2. **Enter a natural language query** (e.g., "Show a bar chart of the top 5 artists by album count").
3. **View the results:**  
   - If the output is a chart, it will be displayed interactively.
   - If the output is text, it will be shown below the query box.

---

## Project Structure

```
AskDB/
├── frontend.py           # Streamlit web app
├── main.py               # Core agent logic (async)
├── helper_functions.py   # Utility functions for HTML saving, etc.
├── tools.py              # Custom LangChain tools (retriever, sandbox)
├── requirements.txt      # Python dependencies
├── README.md             # This file
├── pyproject.toml        # Project metadata and dependencies
├── uv.lock               # Locked dependency versions
```

---

## Notes

- **Temporary files:** Plotly charts are saved as HTML in your system's temp directory (using Python's `tempfile`). They are not persisted after your session ends.
- **Security:** All Python code generated by the LLM is executed in a sandboxed environment for safety.
- **LLM backend:** The default LLM is `qwen2.5` via Ollama. You can change this in `main.py`.

---

## Requirements

- Python 3.8+
- [uv](https://github.com/astral-sh/uv) (for dependency management)
- [Streamlit](https://streamlit.io/)
- [Ollama](https://ollama.com/) (for local LLM inference)
- See `requirements.txt` for all Python dependencies.

---

## License

MIT License

---

## Acknowledgements

- [LangChain](https://github.com/langchain-ai/langchain)
- [Streamlit](https://streamlit.io/)
- [Plotly](https://plotly.com/python/)
- [Ollama](https://ollama.com/)
- [uv](https://github.com/astral-sh/uv)
